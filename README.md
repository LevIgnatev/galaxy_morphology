# galaxy_morphology_ml_captioning
A project to create a multimodal machine learning model for classification of galaxies from survey images with generated natural language captions (for example, "a spiral galaxy with a prominent bulge").


I've been recently very interested in machine learning and spent quite some time exploring the topic, and I created this project to try to test my abilities both in the technical aspect and the ability to finish a full project.


The repo contains data excerpts in /data/, loading code, training code in /src/, notebooks and a small final [demo](https://galaxy-morphology-demo.streamlit.app/).

## **Motivation**

I selected this topic to research because of my long-standing interest in astronomy coming from last summer fixation on the subject and posterior olympiads. The task is classic [classification of galaxies by type](https://en.wikipedia.org/wiki/Galaxy_morphological_classification) (elliptical, spiral, lenticular, irregular, etc.) by image using an ML model, with generated captions added afterward to highlight information from the image. 


## **Goal**

The goal is to classify galaxy morphology and generate short captions from labels. Also show heat maps, with posterior evaluation and [demo](https://galaxy-morphology-demo.streamlit.app/) built for result demonstration.

## **Repo structure**

* **notebooks** - central content of the repo, contains pdf notebooks with code and explanations.
* **src** - the codebase with all the source files
* checkpoints - contains weights of the trained models.
* data/labels - contains the sample images in /thumbs and caption datasets in /captions (labels_manifest_1000.csv is the dataset for the captioner).


## **Plan**

The high-level plan is to:
1) Implement a CNN model
2) Create a pipeline from images to captions
3) Interpret the captions with Grad-CAM or attention
4) Evaluate the results + build a simple demo

## **Data**

I took the Galaxy zoo database from [kaggle](https://www.kaggle.com/datasets/jaimetrickz/galaxy-zoo-2-images) as the primary source of training data for the models.

## **Models to be tested**

I'm still learning about different models, so the list will be updated for sure. For now, the idea is to use a pretrained ResNet for classification and a CNN + LSTM for caption en- and de- coding.
Also, I will use Grad-CAM to visualize attention. Maybe I will try ablation as an experiment.

## **Evaluation**

Evaluation will be done traditionally (accuracy, confusion matrix, F1) for the classifier. For the captioner, the BLEU score will be assessed.
A streamlit demo is available at this link: https://galaxy-morphology-demo.streamlit.app/

## **Reproducibility**

lab_notes.md contains all the logs of my choices, actions, etc. to ensure all the changes are documented + secure ownership. I will also share random seeds, train/test splits, etc.
I will try testing models locally on my home GPU as long as the training is not very demanding computationally.
Edit: this aged poorly, had to resort to a cloud GPU service due to insufficient power of my PC.

Now, an important note about LLMs. I understand that the entirety of this project could be completed in minutes in one prompt to ChatGPT. If I use LLM help in certain steps of the process, it will be documented in lab_notes.md. I can ensure that almost all the work, including evaluation and interpretations of results, will be done by me (hopefully, frequent commits demonstrate it).
If a file or a function contains "AI gen" in the name, it means that its contents have been mostly or entirely generated by AI.
